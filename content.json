{"meta":{"title":"MrzBlog","subtitle":"","description":"No way","author":"Zzzy","url":"http://RookieZ996.github.io","root":"/"},"pages":[{"title":"categories","date":"2020-06-19T12:27:22.000Z","updated":"2020-06-19T12:27:37.816Z","comments":false,"path":"categories/index.html","permalink":"http://rookiez996.github.io/categories/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"},{"title":"tags","date":"2020-06-19T12:26:24.000Z","updated":"2020-06-19T12:27:12.433Z","comments":false,"path":"tags/index.html","permalink":"http://rookiez996.github.io/tags/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"},{"title":"about","date":"2020-06-19T12:27:49.000Z","updated":"2020-06-19T12:27:59.704Z","comments":true,"path":"about/index.html","permalink":"http://rookiez996.github.io/about/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"}],"posts":[{"title":"mysqlLearning/Mysql34题","slug":"mysqlLearning/Mysql34题","date":"2020-06-19T12:19:16.706Z","updated":"2020-05-14T03:14:46.771Z","comments":true,"path":"2020/06/19/mysqlLearning/Mysql34题/","link":"","permalink":"http://rookiez996.github.io/2020/06/19/mysqlLearning/Mysql34%E9%A2%98/","excerpt":"","text":"Mysql34题[TOC] 1.取得每个部门最高薪水的人员名称12345678select e.ename,t.*from (select deptno,max(sal) maxsal from emp group by deptno)tjoin emp eon e.deptno=t.deptno and e.sal=t.maxsal; 2.找出在自己部门平均薪水之上的员工12345678select e.ename,e.sal,t.*from emp ejoin (select deptno,avg(sal) avgsal from emp group by(deptno)) ton e.sal&gt;t.avgsal and e.deptno=t.deptno; 3.取得每个部门平均的薪水等级12345678910select e.deptno,avg(s.grade)from emp ejoin salgrade son e.sal between s.losal and s.hisalgroup by deptno; 4.不使用max函数找出最高工资（两种方法）1.排序 2.自连接 12345678select sal from emp where sal not in (select distinct(a.sal) from emp a join emp b on a.sal&lt;b.sal); 5.取得平均薪水最高的部门的编号方案1 1select deptno,avg(sal) asal from emp group by deptno order by asal desc limit 1; 方案2 12345678select deptno,avg(sal) avgsal from empgroup by deptnohaving avgsal&#x3D;(select max(t.asal) from (select avg(sal) asal from emp group by deptno) t); having的使用不熟练 6.取得平均薪水最高的部门的部门名称123456789101112131415161718192021222324--1select s.*,d.dname from (select deptno,avg(sal) avgsal from emp group by deptno order by avgsal desc limit 1) s join dept d on d.deptno=s.deptno; --2select d.dname,avg(sal) avgsalfrom dept djoin emp eon e.deptno=d.deptnogroup by d.dnameorder by avgsal desclimit 1; 7.求平均薪水等级最低的部门名称123456789101112select t.*,s.grade from (select d.dname,avg(e.sal)avgsal from dept d join emp e on e.deptno=d.deptno group by d.dname)t join salgrade s on t.avgsal between s.losal and s.hisal where grade=(select s.grade from salgrade s where (select avg(e.sal)avgsal from dept d join emp e on e.deptno=d.deptno group by d.dname order by avgsal limit 1) between s.losal and s.hisal); select t.*,s.grade from (select d.dname,avg(e.sal) asal from emp e join dept d on d.deptno=e.deptno group by dname) t join salgrade s on t.asal between s.losal and s.hisal having s.grade=(select s.grade from salgrade s join (select avg(e.sal) avgsal from emp e join dept d on d.deptno=e.deptno group by dname order by avgsal limit 1) t on t.avgsal between s.losal and s.hisal) ; 8.取得工资比普通员工（员工代号没出现在mgr字段上的）的最高薪水还高的领导姓名注意not in时要去掉null 12345---1select distinct m.ename from emp m join emp e where e.mgr=m.empno and m.sal&gt;(select max(e.sal) maxsal from emp e where e.empno not in (select distinct mgr from emp where mgr is not null));---2比普通员工最高薪水还高的一定是领导select e.ename from emp e where e.sal&gt;(select max(e.sal) maxsal from emp e where e.empno not in(select distinct e.mgr from emp e where e.mgr is not null)); 9.取得薪水最高的前五名 10.取得薪水最高的第六到第十名员工limit 第一个参数是起始位置，从0开始记，第二个参数表示长度 11.取得最后入职的5名员工 12.取得每个薪水等级有多少员工1select s.grade,count(s.grade) cnt from emp e join salgrade s on e.sal between s.losal and s.hisal group by grade; 13.有三个表S学生表，C课程表，SC学生选课表，S（SNO,SNAME）代表学生姓名及学号14.列出所有员工及领导姓名注意是左外连接，不能写内连接 1select e.ename,m.ename from emp e left join emp m on e.mgr=m.empno; 15.列出受雇日期早于其直接上级的所有员工的编号，姓名，部门名称。1select t.*,d.dname from (select e.empno,e.ename,e.deptno from emp e join emp m on e.mgr=m.empno and e.hiredate&lt;m.hiredate) t join dept d on t.deptno=d.deptno; 16.列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门1select e.empno,e.ename,d.dname from dept d left join emp e on e.deptno=d.deptno; 17.列出至少有五个员工的所有部门1select deptno from emp group by deptno having count(*)&gt;=5; 18.列出工资比SIMTH高的员工信息1select e.* from emp e where e.sal&gt;(select sal from emp where ename='SMITH'); 19.列出所有CLERK的姓名及部门名称，部门的人数1select t.*,t1.cnt from (select e.ename,e.deptno,d.dname from emp e join dept d on d.deptno=e.deptno where e.job='CLERK') t join (select deptno,count(deptno) cnt from emp group by deptno) t1 on t1.deptno=t.deptno; 20.列出最低薪金大于1500的各种工作及从事此工作的员工数12345678--1(复杂)select job,count(*) cnt from emp group by job;select job,min(sal) losal from emp group by job having losal&gt;1500;select t.*,t1.* from (select job,count(*) cnt from emp group by job) t right join (select job,min(sal) losal from emp group by job having losal&gt;1500) t1 on t1.job=t.job;--2select job,count(*) from emp group by job having min(sal)&gt;1500; 21.列出在SALES工作的员工姓名1select ename from emp where deptno=(select deptno from dept where dname='SALES'); 22.列出薪金高于公司平均薪金的所有员工所在部门，上级领导，员工工资等级。1select e.ename,m.ename mgr,d.dname,e.sal,s.grade from emp e left join emp m on e.mgr=m.empno join dept d on d.deptno=e.deptno join salgrade s on e.sal between s.losal and s.hisal where e.sal&gt;(select avg(sal) from emp); 23.列出与SCOTT从事相同工作的所有员工及部门名称1select e.ename,d.dname from emp e join dept d on d.deptno=e.deptno where e.job=(select job from emp where ename='SCOTT') and e.ename != 'SCOTT'; 24.列出薪资等于30部门中员工薪资的其他员工的姓名和薪资1select ename,sal from emp where sal in (select distinct sal from emp where deptno=30) and deptno&lt;&gt;30; 结果：空表 25.列出薪金高于30部门所有员工薪金的员工姓名和薪金，部门名称1select e.ename,e.sal,d.dname from emp e join dept d on e.deptno=d.deptno where sal &gt;(select max(sal) from emp where deptno=30); 26.列出每个部门工作的员工数量，平均工资和平均服务期限tip: timestampdiff函数 1select d.deptno,count(empno),ifnull(avg(sal),0) AvgSal,ifnull(avg(timestampdiff(year,hiredate,now())),0) AvgServiceYear from emp e right join dept d on e.deptno=d.deptno group by d.deptno; 27.列出所有员工姓名，部门名称和工资。略 28.列出所有部门的详细信息和人数1select d.*,ifnull(count(e.empno),0) cnt from dept d left join emp e on e.deptno=d.deptno group by d.deptno,d.dname,d.loc; 29.列出各种工作的最低工资以及从事此工作的雇员1select t.*,e.ename from emp e join (select job,min(sal) minsal from emp group by job) t on t.job=e.job and t.minsal=e.sal; 30.列出各个部门“manager”的最低薪资1select deptno,min(sal) from emp where job='MANAGER' group by deptno; 31.找出所有员工年薪，从低到高排序1select ename,(sal+ifnull(comm,0))*12 yearsal from emp order by yearsal; 32.求出员工领导薪水超过3000的员工名称与领导名称1select e.ename,m.ename from emp e join emp m on e.mgr=m.empno where m.sal&gt;3000; 33.求出部门名称中带‘S’字符的部门的员工工资合计、部门人数1select d.dname,ifnull(sum(e.sal),0) sumsal,count(e.empno) from dept d left join emp e on e.deptno=d.deptno where d.dname like '%S%' group by dname; 34.给任职超过30年的员工加薪10%1update emp_addsal set sal=sal*1.1 where timestampdiff(year,hiredate,now())&gt;30;","categories":[],"tags":[]}],"categories":[],"tags":[]}