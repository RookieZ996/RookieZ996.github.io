<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    0513/bug&amp;i-got-id-200 |
    
    MrzBlog</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/technology.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <section class="outer">
  <article id="post-0513/bug&amp;i-got-id-200" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      0513/bug&amp;i-got-id-200
    </h1>
  

      </header>
    

    
      <div class="article-meta">
        <a href="/2020/05/25/0513/bug&i-got-id-200/" class="article-date">
  <time datetime="2020-05-25T15:07:14.747Z" itemprop="datePublished">2020-05-25</time>
</a>
        
      </div>
    

    <div class="article-entry" itemprop="articleBody">
      

      

      
        <h2 id="bug"><a href="#bug" class="headerlink" title="bug"></a>bug</h2><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>1.创建账号登陆后发现manage选项只有管理员能点</p>
<p>2.尝试更改用户名为admin，使用找回密码，抓包将用户名修改为admin</p>
<p>3.用admin登陆查看manage发现IP不对，更改XFF头127.0.0.1</p>
<p>4.成功进入manage功能，发现没什么功能。查看源码发现可以传get参数</p>
<p>5.do参数未知，需要我们尝试，尝试include,upload，发现是upload</p>
<p>9.尝试植入php一句话木马，失败，有检测。</p>
<p>10.尝试改后缀为php5，还是不行。</p>
<p>11.用js代码绕过，<strong>后缀继续用php5</strong>，得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;system(&quot;ls&quot;);&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="tip"><a href="#tip" class="headerlink" title="tip"></a>tip</h3><p>1.抓包修改用户名</p>
<p>2.改php后缀为php5</p>
<p>3.利用js代码修改language参数执行php代码</p>
<h2 id="i-got-id-200"><a href="#i-got-id-200" class="headerlink" title="i-got-id-200"></a>i-got-id-200</h2><h3 id="知识背景"><a href="#知识背景" class="headerlink" title="知识背景"></a>知识背景</h3><h4 id="Perl语言（CGI模块）"><a href="#Perl语言（CGI模块）" class="headerlink" title="Perl语言（CGI模块）"></a>Perl语言（CGI模块）</h4><h5 id="1-upload函数用于处理文件上传。函数参数为html代码input标签中的name"><a href="#1-upload函数用于处理文件上传。函数参数为html代码input标签中的name" class="headerlink" title="1.upload函数用于处理文件上传。函数参数为html代码input标签中的name"></a><strong>1.upload函数用于处理文件上传。函数参数为html代码input标签中的name</strong></h5><h5 id="2-param函数用于获取上传的文件。函数参数同upload"><a href="#2-param函数用于获取上传的文件。函数参数同upload" class="headerlink" title="2.param函数用于获取上传的文件。函数参数同upload"></a><strong>2.param函数用于获取上传的文件。函数参数同upload</strong></h5><h5 id="3-Perl使用文件句柄类型的变量来操作文件（包括向文件中读写数据）"><a href="#3-Perl使用文件句柄类型的变量来操作文件（包括向文件中读写数据）" class="headerlink" title="3.Perl使用文件句柄类型的变量来操作文件（包括向文件中读写数据）"></a><strong>3.Perl使用文件句柄类型的变量来操作文件（包括向文件中读写数据）</strong></h5><p>需要使用“&lt;&gt;”运算符，括号内如果是文件句柄，则会读取文件句柄</p>
<h5 id="4-输出文件内容"><a href="#4-输出文件内容" class="headerlink" title="4.输出文件内容"></a><strong>4.输出文件内容</strong></h5><p>这里要用到$_变量</p>
<p><strong>$_是默认参数，在没有指定值得情况下，默认处理上一个变量。</strong></p>
<p>如：读取文件每一行</p>
<p><strong><code>while ( &lt;$file&gt; ) { print &quot;$_&quot;; }</code></strong></p>
<h3 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h3><h5 id="1-新增一个文件上传，删掉文件名。将文件内容改成”ARGV”，此时-file的值变成了ARGV，ARGV会将-ARGV数组的每一项作为文件名并读取。"><a href="#1-新增一个文件上传，删掉文件名。将文件内容改成”ARGV”，此时-file的值变成了ARGV，ARGV会将-ARGV数组的每一项作为文件名并读取。" class="headerlink" title="1.新增一个文件上传，删掉文件名。将文件内容改成”ARGV”，此时$file的值变成了ARGV，ARGV会将@ARGV数组的每一项作为文件名并读取。"></a>1.新增一个文件上传，删掉文件名。将文件内容改成”ARGV”，此时$file的值变成了ARGV，ARGV会将@ARGV数组的每一项作为文件名并读取。</h5><h5 id="2-控制-ARGV数组，只需在url后添加路径即可。此时就能实现任意文件读取"><a href="#2-控制-ARGV数组，只需在url后添加路径即可。此时就能实现任意文件读取" class="headerlink" title="2.控制@ARGV数组，只需在url后添加路径即可。此时就能实现任意文件读取"></a>2.控制@ARGV数组，只需在url后添加路径即可。此时就能实现任意文件读取</h5><h5 id="3-可直接通过读取flag文件获得flag，但是通常需要查找"><a href="#3-可直接通过读取flag文件获得flag，但是通常需要查找" class="headerlink" title="3.可直接通过读取flag文件获得flag，但是通常需要查找"></a>3.可直接通过读取flag文件获得flag，但是通常需要查找</h5><p>查找语句</p>
<p>1.url+“/bin/bash%20-c%20ls$IFS/|”</p>
<p>2.url+“/bin/bash%20-c%20cat${IFS}/flag|”</p>
<p><a href="https://www.guildhab.top/?p=867" target="_blank" rel="noopener">https://www.guildhab.top/?p=867</a></p>
<p><a href="https://blog.csdn.net/qq_41617034/article/details/105518914?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/qq_41617034/article/details/105518914?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.nonecase</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://rookiez996.github.io/2020/05/25/0513/bug&i-got-id-200/" data-id="ckammmwan000ag8ui2pqq36du"
         class="article-share-link">分享</a>
      
    </footer>

  </div>

  
    
  <nav class="article-nav">
    
      <a href="/2020/05/25/0515/EasySQL/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            0515/EasySQL
          
        </div>
      </a>
    
    
      <a href="/2020/05/25/0512/FlatScience&Cat/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">0512/FlatScience&amp;Cat</div>
      </a>
    
  </nav>


  

  
    
  

</article>



</section>
    </div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>






<script src="/js/technology.js"></script>


  </div>
</body>
</html>